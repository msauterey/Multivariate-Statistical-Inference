---
title: "HW7"
author: "Mathieu Sauterey"
date: "April 24, 2018"
output:
  pdf_document: default
  word_document: default
---

# Problem 1

To construct a procedure for detecting potential hemophilia A carriers, blood samples were assayed for two groups of women, and measurements on the variables $x_1$ = $log_{10}$(AHF activity) and $x_2$ = $log_{10}$(AHF antigen) were recorded. (Here "AHF" denotes antihemophilic factor.) The first group of $n_1$ = 30 women were selected from a population $\Pi_1$ of women who do not carry the hemophilia gene. The second group of $n_2$ = 45 women were selected from known hemophilia A carriers (population $\Pi_2$). The data are in the file Hemophilia.csv on the Courseworks page.

(a) Draw the scatterplot of ($x_1$,$x_2$) using a different plotting symbol for carriers versus noncarriers. Does the assumption of bivariate normal populations seem reasonable? Explain.

```{r}

data <- read.csv("Hemophilia.csv")
x1 <- data$x1
x2 <- data$x2

plot(x1[data$Group==1], x2[data$Group==1], pch = 2)
points(x1[data$Group==2], x2[data$Group==2], pch = 3)
```
From the scatterplot it seems not unreasonable to assume that the two populations are bivariate normal with a common covariance matrix. Indeed, the conditional mean function seem linear and the cloud of points is elliptical. 

(b) Use linear discrimination to classify the sample observations, assuming the prior probability of carriers is $\pi_2$ = P($\Pi_2$) = 1/4. Calculate the apparent error rate.


```{r}

data$Group <- as.factor(data$Group)
data$Group

prior <- c(0.75,0.25)

n1 <- sum(data$Group==1)
n2 <- sum(data$Group==2)

xbar1 <- colMeans(data[data$Group==1,2:3])
xbar2 <- colMeans(data[data$Group==2,2:3])

S1 <- cov(data[data$Group==1,2:3])
S2 <- cov(data[data$Group==2,2:3])
S <- 1/(n1+n2-2) * ((n1-1)*S1 + (n2-1)*S2)

library(MASS)
lda.blood <- lda(Group ~ x1+x2, prior=prior, data=data)
xtabs(~ data$Group + predict(lda.blood)$class)

```


(c) Estimate the actual error rate by cross-validation.

```{r}


```


(d) Classify the 10 new cases in Hemo_NewCases.csv using linear discrimination.

```{r}

data_new <- read.csv("Hemo_NewCases.csv")
predict(lda.blood, newdata = data_new, prior=prior)$class

```
